<#setting url_escaping_charset='UTF-8'>
<#macro columnActionsOffer item >
	<@showButton type="see" title="module.stock.billetterie.list_offres.linkShowReservation" href="jsp/admin/plugins/stock/modules/billetterie/ManagePurchase.jsp?offer_id=${item.id!}" />
	<#if ( item.date?date("dd/MM/yyyy") &gt;= currentDate?date("dd/MM/yyyy") ) && ( item.statut != strStatutCancel ) && ( item.quantity > 0 )>
		<a class="btn btn-small btn-primary" title="#i18n{module.stock.billetterie.list_offres.linkCreateReservation}" href="jsp/admin/plugins/stock/modules/billetterie/SavePurchase.jsp?offer_id=${item.id!}"> 
			<i class="icon-plus icon-white"></i>
		</a>
	</#if>
	<a class="btn btn-small btn-success" title="#i18n{module.stock.billetterie.list_offres.linkSendReservation}" href="jsp/admin/plugins/stock/modules/billetterie/SendNotification.jsp?offer_id=${item.id!}&lock=true"> 
		<i class="icon-lock icon-white"></i>
	</a>
	<@showButton type="send" title="module.stock.billetterie.list_offres.linkSendNotification" href="jsp/admin/plugins/stock/modules/billetterie/SendNotification.jsp?offer_id=${item.id!}" />
	<@showButton type="edit" title="module.stock.billetterie.list_offres.linkModifyOffer" href="jsp/admin/plugins/stock/modules/billetterie/SaveOffer.jsp?offer_id=${item.id!}" />
	<@showButton type="clone" title="module.stock.billetterie.list_offres.linkDuplicateOffer" href="jsp/admin/plugins/stock/modules/billetterie/SaveOffer.jsp?offer_id=${item.id!}&duplicate=true" />
	<#if item.statut != strStatutCancel && ( item.date?date("dd/MM/yyyy") &gt;= currentDate?date("dd/MM/yyyy") )>
		<@showButton type="cancel" title="module.stock.billetterie.list_offres.linkCanceloffer" href="jsp/admin/plugins/stock/modules/billetterie/SendNotification.jsp?offer_id=${item.id!}&cancel=true" />
	</#if>
   	<@showButton type="delete" title="module.stock.billetterie.list_offres.linkDeleteOffer" href="jsp/admin/plugins/stock/modules/billetterie/DeleteOffer.jsp?offer_id=${item.id!}" /> 
   	<@showButton type="export" title="module.stock.billetterie.message.buttonExport" href="jsp/admin/plugins/stock/modules/billetterie/DoExportPurchases.jsp?offer_id=${item.id!}" />
</#macro>

<#macro columnStatutOffer item >
	<#if item.statut == strStatutCancel>
		<strong style="color:red">
			<em>#i18n{module.stock.billetterie.list_offres.cancel}</em>
		</strong>
   	<#elseif item.statut == strStatutLock>
   		<strong style="color:red">
   			<em>#i18n{module.stock.billetterie.list_offres.lock}</em>
   		</strong>
   	</#if>
</#macro>

<#macro columnCheckboxDeleteOffer item >
	<input type="checkbox" name="offers_id" value="${item.id!}" />
</#macro>

<#macro columnNameOffer item >
	<a href="jsp/admin/plugins/stock/modules/billetterie/SaveOffer.jsp?offer_id=${item.id!}">
		${item.name!}
	</a>
</#macro>

<#macro columnProductOffer item >
	<a href="jsp/admin/plugins/stock/modules/billetterie/SaveProduct.jsp?product_id=${item.product.id!}">${item.product.name!}</a>
</#macro>

<#macro columnDatesOffer item >
	${item.date!} - ${(item.hour)!}
</#macro>

<#macro columnInitialQuantityOffer item >
	${item.initialQuantity!}
</#macro>

<div class="row-fluid">
	<div class="span12">
		<form action="jsp/admin/plugins/stock/modules/billetterie/ManageOffers.jsp" method="post">
			<fieldset>
				<legend>
					#i18n{module.stock.billetterie.list_offres.title}
					<span class="pull-right spaced">
					  	<a class="btn btn-primary btn-small" href="jsp/admin/plugins/stock/modules/billetterie/SaveOffer.jsp?productId=${(filter.productId)!'0'}" >
					      	<i class="icon-plus icon-white" ></i> <span class="hidden-phone">#i18n{module.stock.billetterie.list_offres.button.createOffer}</span>
					  	</a>
					</span>
				</legend>
				<#list errors as error>
					${error!}
				</#list>
				<div class="row-fluid">
					<div class="span3 well">
						<input type="hidden" name="filter" value="${filter!}" />
						<p>
							<label for="filter_name">#i18n{module.stock.billetterie.list_offres.filter.name} : </label>
							<input class="span"  type="text" name="name" id="filter_name" value="${(filter.name)!}" />
						</p>
						<p>
							<label for="filter_product">#i18n{module.stock.billetterie.list_offres.filter.product} : </label>
							<input class="span"  type="text" name="productName" id="filter_product" value="${(filter.productName)!}" />
						</p>
						<p>
							<label>#i18n{module.stock.billetterie.list_offres.filter.typeOffre} : </label>
				        	<@comboWithParams additionalParameters="class='span'" name="idGenre" default_value="${filter.idGenre!}" items=offerGenre_list! />
						</p>
						<p>
							<label for="filter_date_begin">#i18n{module.stock.billetterie.list_offres.filter.date} : </label>
							<div class="input-prepend">
								<span class="add-on">
									<i class="icon-calendar"></i>
								</span>
								<input class="input-small" type="text" name="dateBegin" id="filter_date_begin" value="${(filter.dateBegin?date)!}"/>
							</div>
							#i18n{module.stock.billetterie.list_offres.filter.dateEt}
							<div class="input-prepend">
								<span class="add-on">
									<i class="icon-calendar"></i>
								</span>
								<input class="input-small" type="text" name="dateEnd" id="filter_date_end" value="${(filter.dateEnd?date)!}"/>
							</div>
							#i18n{module.stock.billetterie.list_offres.filter.dateOuLe}
							<div class="input-prepend">
								<span class="add-on">
									<i class="icon-calendar"></i>
								</span>
								<input class="input-small" type="text" name="dateOr" id="filter_date_or" value="${(filter.dateOr?date)!}"/>
							</div>
						</p>
						<@showSearchButton />
					</div>
					<div class="span9">
						<@dataTable dataTableManager=dataTableOffer />
						<#if dataTableOffer?? && dataTableOffer.items?has_content>
							<button class="btn btn-danger btn-small" type="submit" name="masseDelete">
								<i class="icon-trash icon-white"></i>&nbsp;
								#i18n{module.stock.billetterie.list_offres.button.masseDelete}
							</button>
						</#if>
					</div>
				</div>
			</fieldset>
		</form>
	</div>
</div>
<@getDatePickerRange idFieldFrom="filter_date_begin" idFieldTo="filter_date_end" language="${locale!}" />
<@getDatePicker idField="filter_date_or" language="${locale!}" />
<script src="js/jquery/plugins/ui/ui.datepicker-fr.js"></script>